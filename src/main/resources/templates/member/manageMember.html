<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<head th:include="/common/header"></head>

<body>

    <div id="wrapper">

        <nav th:include="/common/sidebar"></nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">Members</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Add New Member
                        </div>
                        <div class="panel-body">
                            <form role="form" th:action="@{/member/addMember}" th:object="${member}" method="POST">
                                <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group" th:classappend="${#fields.hasErrors('firstName')} ? has-error">
                                        <label>First Name</label>
                                        <input class="form-control" th:field="*{firstName}">
                                        <label th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('middleName')} ? has-error">
                                        <label>Middle Name</label>
                                        <input class="form-control" th:field="*{middleName}">
                                        <label th:if="${#fields.hasErrors('middleName')}" th:errors="*{middleName}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('lastName')} ? has-error">
                                        <label>Last Name</label>
                                        <input class="form-control" th:field="*{lastName}">
                                        <label th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group">
                                        <label>Gender</label>
                                        <div class="radio">
                                            <label style="padding-right: 15px; padding-bottom: 5px;">
                                                <input type="radio" th:field="*{gender}" value="0" checked>Male
                                            </label>
                                            <label>
                                            <input type="radio" th:field="*{gender}" value="1">Female
                                        </label>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label>Birthdate</label>
                                        <!--<input class="form-control" th:field="*{birthdate}" id="datepicker">-->
                                        <input class="form-control" id="birthDate" th:field="*{birthDate}">
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('fatherMemberValue')} ? has-error">
                                        <label>Father Name</label>
                                        <input class="form-control" id="father" name="father">
                                        <input class="form-control" type="hidden" th:field="*{fatherMemberValue}">
                                        <label th:if="${#fields.hasErrors('fatherMemberValue')}" th:errors="*{fatherMemberValue}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('motherMemberValue')} ? has-error">
                                        <label>Mother Name</label>
                                        <input class="form-control" id="mother" name="mother">
                                        <input class="form-control" type="hidden" th:field="*{motherMemberValue}">
                                        <label th:if="${#fields.hasErrors('motherMemberValue')}" th:errors="*{motherMemberValue}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('email')} ? has-error">
                                        <label>Email</label>
                                        <input class="form-control" th:field="*{email}">
                                        <label th:if="${#fields.hasErrors('email')}" th:errors="*{email}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group">
                                        <label>Groups</label>
                                        <select class="form-control" th:field="*{groupId}">
                                            <option th:each="group : ${groups}" th:value="${group.id}" th:text="${group.name}"></option>
                                        </select>
                                    </div>
                                    <input type="hidden" name="id" th:value="*{id}" />
                                    <input type="hidden" th:if="${id != null}" name="createdOn" th:value="*{createdOn}" />
                                    <input type="hidden" th:if="${id != null}" name="createdOn" th:value="*{updatedOn}" />
                                </div>

                                <div class="col-lg-6">
                                    <div class="form-group" th:classappend="${#fields.hasErrors('address.line1')} ? has-error">
                                        <label>Line1</label>
                                        <input class="form-control" th:field="*{address.line1}">
                                        <label th:if="${#fields.hasErrors('address.line1')}" th:errors="*{address.line1}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('address.line2')} ? has-error">
                                        <label>Line2</label>
                                        <input class="form-control" th:field="*{address.line2}">
                                        <label th:if="${#fields.hasErrors('address.line2')}" th:errors="*{address.line2}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('address.landmark')} ? has-error">
                                        <label>Landmark</label>
                                        <input class="form-control" th:field="*{address.landmark}">
                                        <label th:if="${#fields.hasErrors('address.landmark')}" th:errors="*{address.landmark}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('address.city')} ? has-error">
                                        <label>City</label>
                                        <input class="form-control" th:field="*{address.city}">
                                        <label th:if="${#fields.hasErrors('address.city')}" th:errors="*{address.city}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('address.zipcode')} ? has-error">
                                        <label>Zipcode</label>
                                        <input class="form-control" th:field="*{address.zipcode}">
                                        <label th:if="${#fields.hasErrors('address.zipcode')}" th:errors="*{address.zipcode}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('address.state')} ? has-error">
                                        <label>State</label>
                                        <input class="form-control" th:field="*{address.state}">
                                        <label th:if="${#fields.hasErrors('address.state')}" th:errors="*{address.state}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group" th:classappend="${#fields.hasErrors('address.country')} ? has-error">
                                        <label>Country</label>
                                        <input class="form-control" th:field="*{address.country}">
                                        <label th:if="${#fields.hasErrors('address.country')}" th:errors="*{address.country}" class="validation-message"></label>
                                    </div>

                                    <div class="form-group">
                                        <label>Landline Number</label>
                                        <input class="form-control" th:field="*{phones[0].number}">
                                        <input type="hidden" th:field="*{phones[0].type}" th:value="*{phones[0].type}"/>
                                    </div>

                                    <div class="form-group">
                                        <label>Mobile Number</label>
                                        <input class="form-control" th:field="*{phones[1].number}">
                                        <input type="hidden" th:field="*{phones[1].type}" th:value="*{phones[1].type}"/>
                                    </div>
                                </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <button type="submit" class="btn btn-primary pull-right">Submit Button</button>
                                    </div>
                                    <div class="col-lg-6">
                                        <button type="reset" class="btn btn-default">Reset Button</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script>

    // A $( document ).ready() block.
    /*$( document ).ready(function() {

        if($("#fatherMemberValue").val() != ''){
            $('input#father').val($("#fatherMemberValue").val());
        }

        if($("#motherMemberValue").val() != ''){
            $('input#mother').val($("#motherMemberValue").val());
        }

        alert("ready");

    });*/

    $("#birthDate").datepicker({
        inline: true,
        maxDate: 0
    });

    $('#father').autocomplete({
        minLength: 2,
        delay: 100,
        source: function (request, response) {
            $.getJSON("/member/getMember?term=" + request.term, function (data) {
                response($.map(data, function (value) {
                    return {
                        label: value.name,
                        value: value.name,
                        dataValue: value.id
                    };
                }));
            });
        },
        select: function (event, ui) {
            $("input#father").attr("dataValue",ui.item.dataValue);
            $("input#fatherMemberValue").val(ui.item.dataValue);
        }
    });


    $('input#father').on("blur", function() {
        if(typeof $(this).attr("dataValue") === "undefined"){
            $("#fatherMemberValue").val($(this).val());
        }else{
            $("#fatherMemberValue").val($(this).attr("dataValue"));
        }
    });

    $('#mother').autocomplete({
        minLength: 2,
        delay: 100,
        source: function (request, response) {
            $.getJSON("/member/getMember?term=" + request.term, function (data) {
                response($.map(data, function (value) {
                    return {
                        label: value.name,
                        value: value.name,
                        dataValue: value.id
                    };
                }));
            });
        },
        select: function (event, ui) {
            $("input#mother").attr("dataValue",ui.item.dataValue);
            $("input#motherMemberValue").val(ui.item.dataValue);
        }
    });

    $('input#mother').on("blur", function() {
        if(typeof $(this).attr("dataValue") === "undefined"){
            $("#motherMemberValue").val($(this).val());
        }else{
            $("#motherMemberValue").val($(this).attr("dataValue"));
        }
    });
</script>

<footer th:include="/common/footer"></footer>

</html>